<!DOCTYPE html>
<html>
  <head>
    <title>Juzu SDK -- Cobalt</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Streaming Diarization :: Juzu SDK -- Cobalt</title>
<link rel="shortcut icon" href="/sdk-juzu/images/favicon.ico" type="image/x-icon" />
<link href="/sdk-juzu/css/nucleus.css" rel="stylesheet">
<link href="/sdk-juzu/css/font-awesome.min.css" rel="stylesheet">
<link href="/sdk-juzu/css/hybrid.css" rel="stylesheet">
<link href="/sdk-juzu/css/featherlight.min.css" rel="stylesheet">
<link href="/sdk-juzu/css/auto-complete.css" rel="stylesheet">
<link href="/sdk-juzu/theme-original/style.css" rel="stylesheet">

  <link href="/sdk-juzu/theme-original/variant-blue.css" rel="stylesheet">

<link rel="stylesheet" href="/sdk-juzu/css/bootstrap.min.css">
<script src="/sdk-juzu/js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<link href="/sdk-juzu/css/tabs.css" rel="stylesheet" type="text/css">
<script src="/sdk-juzu/js/tabs.js"></script>


    
  </head>
  <body data-url="/sdk-juzu/using-juzu-sdk/streaming/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="showVisitedLinks">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <p><img src="/sdk-juzu/images/logo-white.png" alt="Cobalt's SDK Documentation" /></p>

<p>Juzu SDK &ndash; Cobalt</p>

  


    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="Search...">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="/sdk-juzu/js/lunr.min.js"></script>
		<script type="text/javascript" src="/sdk-juzu/js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "https:\/\/cobaltspeech.github.io\/sdk-juzu";
        
		</script>
		<script type="text/javascript" src="/sdk-juzu/js/search.js"></script>
  </div>

      <ul class="topics">
            <li data-nav-id="/sdk-juzu/" class="dd-item">
            <a href="/sdk-juzu/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/sdk-juzu/getting-started/" class="dd-item
        ">
      <div>
      <a href="/sdk-juzu/getting-started/">Server Setup</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/sdk-juzu/using-juzu-sdk/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/sdk-juzu/using-juzu-sdk/">Using Juzu-SDK</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/sdk-juzu/using-juzu-sdk/installation/" class="dd-item">
        <div>
          <a href="/sdk-juzu/using-juzu-sdk/installation/">
            Installing the SDK
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-juzu/using-juzu-sdk/connecting/" class="dd-item">
        <div>
          <a href="/sdk-juzu/using-juzu-sdk/connecting/">
            Setup Connection
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-juzu/using-juzu-sdk/streaming/" class="dd-item active">
        <div>
          <a href="/sdk-juzu/using-juzu-sdk/streaming/">
            Streaming Diarization
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/sdk-juzu/using-juzu-sdk/client-configs/" class="dd-item">
        <div>
          <a href="/sdk-juzu/using-juzu-sdk/client-configs/">
            Diarization Configurations
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/sdk-juzu/protobuf/" class="dd-item
        ">
      <div>
      <a href="/sdk-juzu/protobuf/">Juzu API Reference</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>



        <section id="shortcuts">
                <li class="" role=""><h3>More</h3><a href="https://github.com/cobaltspeech/sdk-juzu" target="_blank" rel="noopener"><i class='fa fa-github'></i> <label>Github repo</label></a></li>
                <li class="" role=""><a href="https://www.cobaltspeech.com/contact" target="_blank" rel="noopener"><i class='fa fa-bookmark'></i> <label>Contact us</label></a></li>
        </section>
            <a id="clear-history" class="" href="#" data-clear-history-toggle=""><i class="fa  fa-history"></i> Clear History</a>

    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        







 <a href='/sdk-juzu/'>Juzu SDK Documentation</a> > <a href='/sdk-juzu/using-juzu-sdk/'>Using Juzu-SDK</a> > Streaming Diarization

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#streaming-from-an-audio-file">Streaming from an audio file</a></li>
<li><a href="#streaming-from-microphone">Streaming from microphone</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Streaming Diarization</h1>
  



    
    
    
    <p>The following example shows how to diarize and transcribe an audio file using
Juzuâ€™s Streaming Diarize Request. The stream can come from a file on disk or be
directly from a microphone in real time. The diarization (and transcription)
results are returned after the stream is ended and all the audio has been sent
to the server.</p>

<p>For real-time streaming transcription without diarization, call cubicsvr directly.
(See <a href="https://cobaltspeech.github.io/sdk-cubic/using-cubic-sdk/streaming/">StreamingRecognize</a> in the Cubic SDK documentation.)</p>

<h3 id="streaming-from-an-audio-file">Streaming from an audio file</h3>

<p>We support several file formats including RAW, WAV and FLAC. For more details, please
see the protocol buffer specification file in the SDK repository (<a href="https://github.com/cobaltspeech/sdk-juzu/blob/master/grpc/juzu.proto">grpc/juzu.proto</a>).
The examples below use a WAV file as input to the streaming diarization (and
transcription).</p>

<div class='code-tabs'>
  <ul class="nav-tabs"></ul>
  <div class="tab-content">

<div class="tab-pane" title="C#">
  <h4 id="program-cs">Program.cs</h4>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System</span>;
<span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.IO</span>;
<span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.Net</span>;
<span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.Text</span>;
<span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.Threading.Tasks</span>;

<span style="color:#6ab825;font-weight:bold">namespace</span> <span style="color:#447fcf;text-decoration:underline">JuzusvrClient</span> {
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">Program</span> {

        <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">async</span> Task Main (<span style="color:#6ab825;font-weight:bold">string</span><span style="color:#bbb">[]</span> args) {

            <span style="color:#6ab825;font-weight:bold">var</span> url = <span style="color:#ed9d13">&#34;127.0.0.1:2727&#34;</span>;
            <span style="color:#6ab825;font-weight:bold">string</span> audioFile = <span style="color:#ed9d13">&#34;test.wav&#34;</span>;

            <span style="color:#6ab825;font-weight:bold">var</span> insecure = <span style="color:#6ab825;font-weight:bold">true</span>;
            <span style="color:#6ab825;font-weight:bold">var</span> client = <span style="color:#6ab825;font-weight:bold">new</span> Client (url, insecure);

            <span style="color:#999;font-style:italic">// Getting list of diarization models on the server
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#6ab825;font-weight:bold">var</span> modelResp = client.ListModels ();
            Console.WriteLine (<span style="color:#ed9d13">&#34;\nAvailable models:\n&#34;</span>);
            <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> model <span style="color:#6ab825;font-weight:bold">in</span> modelResp.Models) {
                Console.WriteLine (<span style="color:#ed9d13">&#34;{0}\t{1}\t{2}\n&#34;</span>, model.Id, model.Name, model.Attributes.SampleRate);
            }

            <span style="color:#999;font-style:italic">// Creating config for Diarizing + Transcribing file with the first
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#999;font-style:italic">// Juzu Model available and the Cubic model with ID &#34;1&#34; (assigned by
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#999;font-style:italic">// cubicsvr config).
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#6ab825;font-weight:bold">var</span> diarCfg = <span style="color:#6ab825;font-weight:bold">new</span> DiarizationConfig {
                JuzuModelID = modelList.Models<span style="color:#bbb">[0]</span>.Id,
                CubicModelID = <span style="color:#ed9d13">&#34;1&#34;</span>,
                NumSpeakers = <span style="color:#3677a9">2</span>,        <span style="color:#999;font-style:italic">// use 0 if unknown
</span><span style="color:#999;font-style:italic"></span>                SampleRate = <span style="color:#3677a9">16000</span>,
                Encoding = AudioEncoding.WAV,
            };

            <span style="color:#999;font-style:italic">// Define callback function to print results on screen; could be
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#999;font-style:italic">// modified to do other things with the results as well.
</span><span style="color:#999;font-style:italic"></span>            ResponseHandler handleFunc = <span style="color:#6ab825;font-weight:bold">delegate</span> (CobaltSpeech.Juzu.DiarizationResponse resp) {
                <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> result <span style="color:#6ab825;font-weight:bold">in</span> resp.Results) {
                    <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> seg <span style="color:#6ab825;font-weight:bold">in</span> result.Segments) {
                        Console.WriteLine (<span style="color:#ed9d13">&#34;{0} : {1}\t{2}\t{3}&#34;</span>,
                            seg.StartTime, seg.EndTime, seg.SpeakerLabel, seg.Transcript);
                    }
                }
            };

            <span style="color:#999;font-style:italic">// StreamingDiarizeAsync takes any readable Stream.IO object, that is
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#999;font-style:italic">// only the Stream.IO.Read method needs to be implemented.
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#6ab825;font-weight:bold">using</span> (FileStream file = File.OpenRead (audioFile)) {
                <span style="color:#6ab825;font-weight:bold">await</span> client.StreamingDiarizeAsync (file, diarCfg, handleFunc);
            }
        }
    }
}
</code></pre></div>
<h4 id="juzusvrclient-csproj">JuzusvrClient.csproj</h4>
<div class="highlight"><pre style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">&lt;Project Sdk=<span style="color:#ed9d13">&#34;Microsoft.NET.Sdk&#34;</span>&gt;

  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;netcoreapp3.<span style="color:#3677a9">0</span>&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include=<span style="color:#ed9d13">&#34;Juzu-SDK&#34;</span> Version=<span style="color:#ed9d13">&#34;0.9.3&#34;</span> /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre></div>
</div>

<p></div>
</div></p>

<h3 id="streaming-from-microphone">Streaming from microphone</h3>

<p>Streaming audio from microphone input typically needs us to interact with system
libraries. There are several options available, and although the examples here use
one, you may choose to use an alternative as long as the recording audio format is
chosen correctly.</p>

<div class='code-tabs'>
  <ul class="nav-tabs"></ul>
  <div class="tab-content">

<div class="tab-pane" title="C#">
  <p>We do not currently have example C# code for streaming from a microphone. Simply
pass the bytes from the microphone the same as is done from the file in the
<a href="#streaming-from-an-audio-file"><code>Streaming from an audio file</code></a> example above via
a class derived from <a href="https://docs.microsoft.com/en-us/dotnet/api/system.io.stream"><code>Stream.IO</code></a>.
with the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.io.stream.read#System_IO_Stream_Read_System_Byte___System_Int32_System_Int32_"><code>int Read(buffer byte[], offset int, count int)</code></a> method implemented.</p>

</div>

<p></div>
</div></p>

    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="/sdk-juzu/using-juzu-sdk/connecting/" title="Setup Connection"> <i class="fa fa-chevron-left"></i><label>Setup Connection</label></a>
    <a class="nav nav-next" href="/sdk-juzu/using-juzu-sdk/client-configs/" title="Diarization Configurations" style="margin-right: 0px;"><label>Diarization Configurations</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="/sdk-juzu/js/clipboard.min.js"></script>
<script src="/sdk-juzu/js/featherlight.min.js"></script>
<script src="/sdk-juzu/js/html5shiv-printshiv.min.js"></script>

<script src="/sdk-juzu/js/modernizr.custom.71422.js"></script>
<script src="/sdk-juzu/js/docdock.js"></script>
<script src="/sdk-juzu/theme-original/script.js"></script>


    

    
    

    
  </body>
</html>